<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"></meta><link rel="stylesheet" type="text/css" href="v8help://service_book/service_style"></link><meta name="GENERATOR" content="MSHTML 9.00.8112.16457"></meta></head><body>
<h1>Справочник «Конвертации»</h1>
<p>Понятие конвертации весьма абстрактно. Это может быть настройка преобразования одного вида документа в другой (например, выгрузка расходной накладной и конвертация ее в загружаемую приходную накладную), это может быть синхронизация справочников (например: единая номенклатура холдинга), настройка перехода на другую конфигурацию или новую редакцию конфигурации и т.д. Каждый элемент этого справочника имеет реквизиты «Источник» и «Приемник», которые ссылаются на справочник <a href="Catalog.Конфигурации/Help">«Конфигурации»</a>. Таким образом, в настройках конвертации, прежде всего, определяется между какими конфигурациями осуществляется обмен и в каком направлении. При этом может быть множество конвертаций, у которых и источник, и приемник – одна и та же конфигурация. Таким образом, конвертация, в большей степени, определяется правилами обмена, настройки которых хранятся в подчиненных справочниках <a href="Catalog.ПравилаКонвертацииОбъектов/Help">«Правила конвертации объектов»</a>, <a href="Catalog.ПравилаВыгрузкиДанных/Help">«Правила выгрузки данных»</a> и <a href="Catalog.ПравилаОчисткиДанных/Help">«Правила очистки данных»</a>. Для элементов справочника "Конвертации" (и подчиненных им справочников) может быть выполнено сравнение друг с другом. Сравнение конвертаций выполняется с помощью обработки <a href="DataProcessor.СравнениеИОбъединениеПравилОбмена.Form.Форма/Help">"Сравнение и объединение правил обмена"</a>.</p>
<p>Результатом настройки конвертации является файл правил обмена. Полное имя файла правил обмена храниться раздельно для каждого пользователя и может быть указано в форме элемента. Настройка и выгрузка правил обмена в файл осуществляется в общей форме <a href="CommonForm.ПравилаОбмена/Help">"Настройка правил обмена"</a>.</p>
<p>В форме элемента справочника "Конвертации" на закладке "События" могут быть настроены обработчики событий конвертации. Обработчики событий представляют собой фрагменты алгоритмов (скрипты), реализованные на встроенном языке 1С:Предприятия и выполняемые в определенные моменты выгрузки и загрузки данных.</p>
<p>На закладке «Дополнительно» можно установить режим совместимости. Значение «Не использовать» включает возможность использовать режим отладки, и предназначено для правил, используемых для периодических обменов между конфигурациями на базе БСП версии 2.1 и выше. Значение «Версия БСП 2.0» необходимо выбрать, если правила созданы для периодических обменов между конфигурациями на базе БСП ниже версии 2.1. Пустое значение задается по умолчанию и используется для всех остальных случаев.</p>
<p>На закладке "Параметры" можно определить вспомогательные параметры конвертации. Это, по сути, глобальные переменные конвертации, т.е. переменные доступ к которым возможен в любых обработчиках событий правил обмена. Обращение к параметрам осуществляется так:  </p>
<p>Параметры.&lt;ИмяПараметра&gt;</p>
<p>Одним из типичных вариантов использования параметров является их инициализация в обработчиках конвертации "Перед выгрузкой данных" или "Перед загрузкой данных" для последующего анализа в событиях правил обмена. Например, определив перед выгрузкой данных параметр ОтборДокументовПоСкладу:</p>
<p>Параметры.ОтборДокументовПоСкладу = Константы.ОсновнойСклад.Получить();</p>
<p>можно в соответствующих <a href="Catalog.ПравилаВыгрузкиДанных/Help">правилах выгрузки данных</a>  (или событии конвертации "Перед выгрузкой объекта") использовать фильтрацию документов по определенному складу. Параметры конвертации могут инициализироваться также в подключаемых интерфейсных обработках.</p>
<p>На закладке "Подключаемые обработки" могут быть загружены произвольные внешние обработки, используемые в процессе обмена. Можно выделить два основных варианта использования подключаемых обработок.</p>
<p>Вариант 1: Подключаемая обработка является своего рода библиотекой экспортируемых процедур / функций, используемых в процессе обмена.</p>
<p>Вариант 2: Подключаемая обработка поставляет форму интерфейсной настройки параметров обмена. Например, пользователю в удобном виде может быть предоставлена возможность настроить отбор выгружаемых / загружаемых данных. </p>
<p>Подключаемых обработок для обоих вариантов может быть произвольное количество. Для интерфейсных обработок необходимо установить флажок "Это обработка формы настройки". В этом случае, в обработке "Универсальный обмен данными", после загрузки правил обмена, становиться доступной кнопка настройки, по нажатию на которую, либо открывается форма настройки, либо выпадает меню (если подключено несколько интерфейсных обработок). При настройке интерфейсной обработки, могут быть указаны параметры обработки, связанные с параметрами  конвертации. В этом случае, необходимые параметры конвертации инициализируются автоматически. Указанные параметры, должны совпадать с одноименными реквизитами обработки или реквизитами основной формы обработки. Инициализация параметров конвертации происходит, если при закрытии формы настройки возвращается значение отличное от Неопределено, в противном случае считается, что пользователь нажал кнопку "Отмена", т.е. закрыл форму без сохранения изменений.</p>
<p>Доступ к подключаемым обработкам в обработчиках событий обмена осуществляется так:</p>
<p>ДопОбработки.&lt;ИмяОбработки&gt;.&lt;ИмяЭкспортируемойПроцедурыИлиФункции()&gt;</p></body></html>